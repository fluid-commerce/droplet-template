{"version":3,"file":"p-CSW6az26.js","sources":["../embeddable-prepared-build/getStackedChartData-DmWnIJXP-BGfyqr4T.js"],"sourcesContent":["import { c as I } from \"./format-TjzP8gQX-oHZX7qOo.js\";\nfunction j(C, E, y) {\n  var f, x, b;\n  const {\n    displayAsPercentage: O,\n    granularity: i,\n    maxSegments: c,\n    metric: v,\n    results: s,\n    segment: u,\n    showTotals: w,\n    theme: r,\n    totals: F,\n    useCustomDateFormat: A,\n    xAxis: o\n  } = C, p = [...new Set((f = s == null ? void 0 : s.data) == null ? void 0 : f.map((a) => a[(o == null ? void 0 : o.name) || \"\"]))], h = k(), m = {}, T = (y == null ? void 0 : y.chartType) === \"stackedAreaChart\" ? 0 : null;\n  p.forEach((a) => {\n    const e = {};\n    h.forEach((t) => e[t] = T), m[a] = e;\n  }), (x = s == null ? void 0 : s.data) == null || x.forEach((a) => {\n    const e = a[(u == null ? void 0 : u.name) || \"\"], t = a[(o == null ? void 0 : o.name) || \"\"], n = a[(v == null ? void 0 : v.name) || \"\"];\n    h.includes(e) ? m[t][e] = parseFloat(n) : m[t].Other = (m[t].Other || 0) + parseFloat(n);\n  });\n  let g;\n  return A && i ? g = r.dateFormats[i] : o.nativeType === \"time\" && (i && r.dateFormats[i] ? g = r.dateFormats[i] : (b = o == null ? void 0 : o.inputs) != null && b.granularity && r.dateFormats[o.inputs.granularity] && (g = r.dateFormats[o.inputs.granularity])), {\n    labels: p.map((a) => I(a, { meta: o == null ? void 0 : o.meta, dateFormat: g })),\n    datasets: h.map((a, e) => ({\n      ...E,\n      backgroundColor: r.charts.colors[e % r.charts.colors.length],\n      borderColor: r.charts.colors[e % r.charts.colors.length],\n      label: a,\n      // this is actually segment name, not label, but chart.js wants \"label\" here\n      data: p.map((t) => {\n        const n = m[t][a];\n        return w && F && n !== null && (F[t].lastSegment = e), O && n !== null ? parseFloat(\n          `${n * 100 / h.reduce((d, l) => m[t][l] === null ? d : m[t][l] + d, 0)}`\n        ) : n;\n      }),\n      xAxisNames: p,\n      totals: F\n    }))\n  };\n  function k() {\n    var a, e;\n    const t = [\n      ...new Set((a = s == null ? void 0 : s.data) == null ? void 0 : a.map((l) => l[(u == null ? void 0 : u.name) || \"\"] || \"No value\"))\n    ];\n    if (!c || t.length <= c || c < 1)\n      return t;\n    const n = {};\n    (e = s == null ? void 0 : s.data) == null || e.forEach(\n      (l) => n[l[(u == null ? void 0 : u.name) || \"\"]] = (n[l[(u == null ? void 0 : u.name) || \"\"]] || 0) + parseInt(l[(v == null ? void 0 : v.name) || \"\"])\n    );\n    const d = Object.keys(n).map((l) => ({\n      name: l,\n      value: n[l]\n    })).sort((l, S) => S.value - l.value).slice(0, c).map((l) => l.name);\n    return d.push(\"Other\"), d;\n  }\n}\nexport {\n  j as q\n};\n//# sourceMappingURL=getStackedChartData-DmWnIJXP-BGfyqr4T.js.map\n"],"names":["I"],"mappings":"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"}